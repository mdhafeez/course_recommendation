{% extends "base.html" %}

{% block title %}Data Visualization 2{% endblock %}

{% block content %}
<div class="container">
    <h1 class="my-4">Data Visualization 2</h1>
    
    <!-- Dropdown and Range Slider Form -->
    <form method="POST">
        <!-- Dropdown for selecting the type of visualization -->
        <div class="form-group">
            <label for="visualization_selector">Select Visualization:</label>
            <select id="visualization_selector" name="visualization_selector" class="form-control">
                <option value="year_distribution" {% if selected_visualization == 'year_distribution' %}selected{% endif %}>Course Distribution by Year</option>
                <option value="duration_by_field" {% if selected_visualization == 'duration_by_field' %}selected{% endif %}>Average Course Duration by Field</option>
                <option value="subfield_distribution" {% if selected_visualization == 'subfield_distribution' %}selected{% endif %}>Courses by Sub-Field</option>
                <option value="participant_scheme_distribution" {% if selected_visualization == 'participant_scheme_distribution' %}selected{% endif %}>Participant Scheme Distribution</option>
                <option value="trends_over_time" {% if selected_visualization == 'trends_over_time' %}selected{% endif %}>Trends Over Time by Field</option>
                <option value="trends_schemes_over_time" {% if selected_visualization == 'trends_schemes_over_time' %}selected{% endif %}>Trends in Participant Schemes Over Time</option>
            </select>
        </div>

        <!-- Range Slider for selecting the year range -->
        <div class="form-group">
            <label for="year_range_min">Select Year Range:</label>
            <input type="range" class="form-control" name="year_range_min" id="year_range_min" min="2020" max="2024" value="{{ selected_year_range[0] }}">
            <input type="range" class="form-control" name="year_range_max" id="year_range_max" min="2020" max="2024" value="{{ selected_year_range[1] }}">
            <p>Selected Range: <span id="year_range_min_value">{{ selected_year_range[0] }}</span> - <span id="year_range_max_value">{{ selected_year_range[1] }}</span></p>
        </div>

        <div class="text-center">
            <button type="submit" class="btn btn-primary">Generate</button>
        </div>
    </form>

    <!-- Chart Display -->
    <div class="mt-5">
        {{ plot|safe }}
    </div>
</div>

<script>
    // Update year range display on slider input
    var min_slider = document.getElementById("year_range_min");
    var max_slider = document.getElementById("year_range_max");
    var min_output = document.getElementById("year_range_min_value");
    var max_output = document.getElementById("year_range_max_value");

    min_slider.oninput = function() {
        min_output.innerHTML = this.value;
    }
    
    max_slider.oninput = function() {
        max_output.innerHTML = this.value;
    }
</script>
{% endblock %}
